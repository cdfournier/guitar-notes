<!DOCTYPE html>
<html lang="en">

  <head>
    <title>
      <%= title %>
    </title>
    <%- include('includes/head', { title }); %>
    <style>
      main.index article section h4 {
        opacity: 0.5;
      }

      @media (min-width: 48rem) {
        main.index section {
          column-count: 2;
          column-gap: 2rem;
        }
      }

      @media (min-width: 64rem) {
        main.index section {
          column-count: 3;
        }
      }

      @media (min-width: 90rem) {
        main.index section {
          column-count: 4;
        }
      }

      @media (min-width: 106rem) {
        main.index section {
          column-count: 5;
        }
      }
    </style>
  </head>

  <body class="hidden">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TF6BNKF"
              height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <header>
      <h1>Welcome to <%= title %>
      </h1>
      <form>
        <fieldset>
          <label>
            <span class="label">Search</span>
            <input type="text" id="search" onkeyup="searchSongs()" placeholder="Search songs" title="Search">
            <span class="icon">
              <svg class="icon-search" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <path d="M0 0h24v24H0z" stroke="none" />
                <circle cx="10" cy="10" r="7" />
                <path d="m21 21-6-6" />
              </svg>
            </span>
            <button type="reset" id="reset" class="clear-search" value="Reset">
              <span class="visuallyhidden">Reset</span>
              <svg xmlns="http://www.w3.org/2000/svg" class="icon-x" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <path d="M0 0h24v24H0z" stroke="none" />
                <path d="M18 6 6 18M6 6l12 12" />
              </svg>
            </button>
          </label>
        </fieldset>
      </form>
    </header>
    <main id="content" class="index">
      <div style="display: none;" id="clock" class="clock" onload="showTime()" aria-live="polite"></div>
      <article>
        <h2 class="visuallyhidden">
          <%= title %> List Index
        </h2>
        <section id="list">
          <h2>Current list:</h2>
          <!-- <small style="display: block; column-span: all;">* denotes a work in progress</small> -->
          <% groups.forEach(function (group) { %>
            <h4><%= group.artist %></h4>
            <% group.songs.forEach(function (song) { %>
              <p>
                <a href="<%= basePath %>/songs/<%= song['artist-song'] %>/?lab=1" target="_blank" rel="noopener noreferrer">
                  <%= song.song %>
                  <% if (song.new) { %><span class="badge">new</span><% } %>
                </a>
              </p>
            <% }) %>
          <% }) %>
        </section>
      </article>
    </main>
    <footer>
      <%- include('includes/footer-about'); %>
    </footer>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="<%= basePath %>/assets/js/site.js"></script>
    <script src="<%= basePath %>/assets/js/headroom.js"></script>
    <script>
      // CHANGE CSS WHEN PAGE LOADS
      $(document).ready(function () {
        $("body").addClass("visible");
        $("body").removeClass("hidden");
      });
      // HEADROOM
      var myElement = document.querySelector("header");
      var headroom = new Headroom(myElement);
      headroom.init();
    </script>
    <script>
      function searchSongs() {
        var input, filter, section, p, a, i, txtValue;
        input = document.getElementById("search");
        filter = input.value.toUpperCase();
        section = document.getElementById("list");
        p = section.getElementsByTagName("p");
        for (i = 0; i < p.length; i++) {
          a = p[i].getElementsByTagName("a")[0];
          txtValue = a.textContent || a.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            p[i].style.display = "";
          } else {
            p[i].style.display = "none";
          }
        }
      }
      // RESET
      $('button#reset').click(function () {
        var input, filter, section, p, a, i, txtValue;
        input = document.getElementById("search");
        filter = input.value.toUpperCase();
        section = document.getElementById("list");
        p = section.getElementsByTagName("p");
        for (i = 0; i < p.length; i++) {
          a = p[i].getElementsByTagName("a")[0];
          txtValue = a.textContent || a.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            p[i].style.display = "none";
          } else {
            p[i].style.display = "";
          }
        }
      });
    </script>
  </body>

</html>
